<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>🎯Gerador De Bilhete🎟️</title>

<!-- PWA -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#00ff99">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<link rel="apple-touch-icon" href="icon-192.png">

<!-- CSS -->
<style>
body { margin:0; font-family:'Poppins', sans-serif; background:#0e0e0e; color:#f1f1f1; text-align:center; overflow-x:hidden; }
header h1 { color:#00ff99; margin-top:30px; text-shadow:0 0 5px #00ff99; }
.container { background:#1b1b1b; padding:25px; border-radius:12px; width:90%; max-width:700px; margin:30px auto; box-shadow:0 0 25px rgba(0,255,153,0.2); }
label { display:block; margin:10px auto; width:80%; text-align:left; color:#ddd; }
input { width:100%; padding:8px; margin-top:5px; border-radius:6px; border:1px solid #444; background:#2a2a2a; color:#fff; transition:0.2s; }
input:focus { border-color:#00ff99; outline:none; }
.markets { display:flex; flex-wrap:wrap; justify-content:center; margin:10px 0; }
.market-btn { margin:5px; padding:8px 12px; border:none; border-radius:8px; cursor:pointer; background:#333; color:#fff; transition:0.2s; box-shadow:0 0 3px rgba(0,255,153,0.2); }
.market-btn.active { background:#00ff99; color:#000; transform:scale(1.05); }
.market-btn:hover { opacity:0.8; }
button#gerar, button#copiar, button#baixar, button#estatisticasBtn { background:#00ff99; color:#000; font-weight:bold; border:none; padding:10px 20px; margin:10px 5px; border-radius:8px; cursor:pointer; transition:0.2s; box-shadow:0 0 5px #00ff99; }
button#gerar:hover, button#copiar:hover, button#baixar:hover, button#estatisticasBtn:hover { background:#00cc7a; transform:scale(1.05); }
#bilheteContainer { margin-top:20px; display:flex; flex-direction:column; gap:15px; }
.bilhete-card { background:#111; border:1px solid #00ff99; border-radius:10px; padding:15px; text-align:left; opacity:0; transform:translateY(20px); transition: all 0.5s ease, box-shadow 0.3s ease; }
.bilhete-card.show { opacity:1; transform:translateY(0); }
.bilhete-card:hover { box-shadow:0 0 15px #00ff99; }
.bilhete-card span { font-weight:bold; }
.stat-green { color:#00ff99; }
.stat-yellow { color:#ffcc00; }
.stat-red { color:#ff4d4d; }
.totalOdd { font-size:18px; font-weight:bold; color:#00ff99; text-align:center; margin-top:15px; animation: pulse 1s infinite alternate; }
@keyframes pulse { 0%{text-shadow:0 0 5px #00ff99;} 100%{text-shadow:0 0 20px #00ff99;} }
.legend { font-size:13px; text-align:left; margin-top:20px; }
.footer { color:#666; font-size:13px; margin-top:40px; }
#estatisticasModal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95); color:#fff; z-index:1000; overflow:auto; padding:20px; }
#estatisticasModal h2 { margin-top:0; }
#closeEstatisticas { float:right; background:#00ff99; color:#000; border:none; border-radius:6px; padding:5px 10px; cursor:pointer; }
@media(max-width:500px){ .container{padding:15px; width:95%;} }
</style>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>

<header>
<h1>🎯Gerador De Bilhete🎟️</h1>
</header>

<div class="container">

<p>Filtros de bilhete:</p>

<label>Quantidade de jogos:
<input id="qtd" type="number" min="1" value="3">
</label>

<label>Odd mínima por jogo:
<input id="min" type="number" step="0.01" value="1.20">
</label>

<label>Odd máxima por jogo:
<input id="max" type="number" step="0.01" value="2.50">
</label>

<div class="markets">
<button class="market-btn active" data-market="+1.5 gols">+1.5 Gols</button>
<button class="market-btn active" data-market="ambas">Ambas Marcam</button>
<button class="market-btn active" data-market="vitória casa">Vitória Casa</button>
<button class="market-btn active" data-market="vitória fora">Vitória Fora</button>
</div>

<button id="gerar">Gerar Bilhete</button>
<button id="copiar">📋 Copiar Bilhete</button>
<button id="baixar">💾 Baixar PDF</button>
<button id="estatisticasBtn">📊 Estatísticas</button>

<div id="bilheteContainer"></div>
<div id="totalOdd" class="totalOdd"></div>

<p class="legend">
🔹 JC = Jogos do time da casa acertando este mercado<br>
🔹 JF = Jogos do time visitante acertando este mercado<br>
🔹 CD = Confrontos diretos acertando este mercado
</p>

</div>

<div id="estatisticasModal">
<button id="closeEstatisticas">Fechar</button>
<h2>📊 Estatísticas do Gerador</h2>
<div id="estatisticasConteudo"></div>
</div>

<div class="footer">Desenvolvido por Kawan • Estatísticas coloridas</div>

<script>
const palpites=[
{jogo:"Flamengo x Palmeiras", mercado:"+1.5 gols", odd:1.45, jc:"3/5", jf:"3/5", cd:"3/5"},
{jogo:"Mirassol x São Paulo", mercado:"+1.5 gols", odd:1.50, jc:"9/10", jf:"3/5", cd:"11/12"},
{jogo:"Getafe x Real Madrid", mercado:"vitória fora", odd:1.40, jc:"4E 1V", jf:"4V 1D", cd:"8/10"},
{jogo:"Celta de Vigo x Real Sociedad", mercado:"+0.5 gols casa", odd:1.22, jc:"5/5", jf:"4/5", cd:"4/5"},
{jogo:"Como x Juventus", mercado:"+1.5 gols", odd:1.40, jc:"10/10", jf:"4/5", cd:"4/4"},
{jogo:"Milan x Fiorentina", mercado:"vitória casa", odd:1.55, jc:"4V 1D", jf:"4E 1V", cd:"2V 2D 1E"}
];

const container=document.getElementById("bilheteContainer");
const marketBtns=document.querySelectorAll(".market-btn");
const totalOddEl=document.getElementById("totalOdd");

// Toggle mercados
marketBtns.forEach(btn=>{btn.addEventListener("click",()=>{btn.classList.toggle("active");});});

// Função para cor dos stats
function getColor(stat){
  if(stat.includes("V")||parseInt(stat.split("/")[0])/parseInt(stat.split("/")[1])>=0.7) return "stat-green";
  if(stat.includes("E")||parseInt(stat.split("/")[0])/parseInt(stat.split("/")[1])>=0.5) return "stat-yellow";
  return "stat-red";
}

// Salvar histórico no localStorage
function salvarHistorico(sorteados){
  const historico=JSON.parse(localStorage.getItem('historicoBilhetes')||'[]');
  const timestamp=new Date().toLocaleString();
  sorteados.forEach(p=>{
    const jcPercent=Math.round(parseInt(p.jc.split("/")[0])/parseInt(p.jc.split("/")[1])*100);
    const jfPercent=Math.round(parseInt(p.jf.split("/")[0])/parseInt(p.jf.split("/")[1])*100);
    const cdPercent=Math.round(parseInt(p.cd.split("/")[0])/parseInt(p.cd.split("/")[1])*100);
    const chanceGreen=Math.round((jcPercent+jfPercent+cdPercent)/3);
    historico.push({
      jogo:p.jogo,
      mercado:p.mercado,
      odd:p.odd,
      jc:p.jc,
      jf:p.jf,
      cd:p.cd,
      green: chanceGreen,
      horario:timestamp
    });
  });
  localStorage.setItem('historicoBilhetes', JSON.stringify(historico));
}

// Gerar bilhete
function gerarBilhete(){
  const qtd=parseInt(document.getElementById("qtd").value);
  const min=parseFloat(document.getElementById("min").value);
  const max=parseFloat(document.getElementById("max").value);
  const mercados=Array.from(document.querySelectorAll(".market-btn.active")).map(b=>b.dataset.market.toLowerCase());
  let filtrados=palpites.filter(p=>p.odd>=min&&p.odd<=max&&mercados.includes(p.mercado.toLowerCase()));
  if(filtrados.length===0){container.innerHTML="❌ Nenhum jogo encontrado"; totalOddEl.textContent=""; return;}
  const sorteados=filtrados.sort(()=>0.5-Math.random()).slice(0,qtd);
  container.innerHTML=""; totalOddEl.textContent="";
  let totalOdd=1;
  sorteados.forEach((p,i)=>{
    totalOdd*=p.odd;
    const jcC=getColor(p.jc), jfC=getColor(p.jf), cdC=getColor(p.cd);
    const jcPercent=Math.round(parseInt(p.jc.split("/")[0])/parseInt(p.jc.split("/")[1])*100);
    const jfPercent=Math.round(parseInt(p.jf.split("/")[0])/parseInt(p.jf.split("/")[1])*100);
    const cdPercent=Math.round(parseInt(p.cd.split("/")[0])/parseInt(p.cd.split("/")[1])*100);
    const chanceGreen=Math.round((jcPercent+jfPercent+cdPercent)/3);
    const card=document.createElement("div");
    card.className="bilhete-card show";
    card.innerHTML=`<strong>🏆 ${i+1}. ${p.jogo}</strong><br>
    Mercado: ${p.mercado} | Odd: ${p.odd}<br>
    JC: <span class="${jcC}">${p.jc} (${jcPercent}%)</span> | 
    JF: <span class="${jfC}">${p.jf} (${jfPercent}%)</span> | 
    CD: <span class="${cdC}">${p.cd} (${cdPercent}%)</span><br>
    🔹 Chance de green: ${chanceGreen}% ✅`;
    container.appendChild(card);
  });
  totalOddEl.textContent=`💰 Odd Total: ${totalOdd.toFixed(2)}`;
  salvarHistorico(sorteados);
}

// Copiar bilhete
document.getElementById("copiar").addEventListener("click",()=>{
  let texto="";
  document.querySelectorAll(".bilhete-card").forEach(c=>texto+=c.innerText+"\n-----------------------------------\n");
  navigator.clipboard.writeText(texto);
  alert("Bilhete copiado!");
});

// Baixar PDF
document.getElementById("baixar").addEventListener("click",()=>{
  const {jsPDF}=window.jspdf;
  const doc=new jsPDF();
  let y=10;
  document.querySelectorAll(".bilhete-card").forEach(c=>{
    const lines=c.innerText.split("\n");
    lines.forEach(l=>{doc.text(l,10,y); y+=7;});
    y+=5;
  });
  doc.save(`bilhete-${Date.now()}.pdf`);
});

// Estatísticas detalhadas
document.getElementById("estatisticasBtn").addEventListener("click",()=>{
  const modal=document.getElementById("estatisticasModal");
  const conteudo=document.getElementById("estatisticasConteudo");
  const historico=JSON.parse(localStorage.getItem('historicoBilhetes')||'[]');
  if(historico.length===0){conteudo.innerHTML="Nenhum bilhete gerado ainda."; modal.style.display="block"; return;}
  
  // Bilhetes gerados
  const bilhetesGerados=new Set(historico.map(h=>h.horario)).size;
  
  // Palpites gerados
  const palpitesGerados=historico.length;
  
  // Times diferentes
  const times=[];